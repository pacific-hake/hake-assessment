\newpage

\rfoot{SRG requests}

# SRG requests {#sec:app-srg-requests}

## Day 1

### Request 1:

**SRG request**:
Summarize the number of aged fish by month for each sector in the US and Canada (if possible). Compare these to the monthly catch plots.

**Justification:**
This will help to determine if the age data are representative of the fishery catches. If the number of ages are consistent with the catch, then the ages are likely to be representative.

(ref:srg-catch-by-month-cap) Catch by month in `r last_data_yr` for all sectors of the U.S. and fleets of Canada.

(ref:srg-catch-by-month-alt) The figure shows that 

```{r srg-catch-by-month-fig, fig.cap = "(ref:srg-catch-by-month-cap)", fig.height = 5, fig.asp = 0.8, out.height = "6in"}

plot_catch_by_month(list(us_ss_catch_by_month_df,
                         can_ss_catch_by_month_df,
                         us_cp_catch_by_month_df,
                         can_ft_catch_by_month_df,
                         us_ms_catch_by_month_df),
                    list("U.S. Shoreside",
                         "Canadian Shoreside",
                         "U.S. Catcher-Processor",
                         "Canadian Freezer-Trawlers",
                         "U.S. Mothership"),
                    type = "catch",
                    disclaimer_text = paste0(
                      "These plots have different y-axis ranges\n",
                      "and are not directly comparable\n",
                      "with each other."),
                    yrs = c(2025, 2025),
                    leg_font_size = 8,
                    title_font_size = 10,
                    ax_text_x = 8,
                    ax_text_y = 8)
```

#### Request 1 Results: Sector/Fleet-based Samples by Month

```{r srg-age-comp-comparison, results = "asis"}

sample_df <- canada_load_sample_data() |> 
  dplyr::filter(sex %in% c(1, 2))

samples_fleet_lst <- canada_get_fleet_samples(sample_df)
# Remove JV for this table
samples_fleet_lst <- samples_fleet_lst[names(samples_fleet_lst) != "jv"]

samples_summary_tbls_lst <- canada_extract_sampling_by_month(
  samples_fleet_lst,
  yr = last_data_yr)
```

**Canadian Fleets**
```{r srg-canada-sample-summary-ft-tab, results = "asis"}

cap <- paste0("Canadian sampling by month for ", last_data_yr, " in the Freezer trawler sector.")
table_sampling_by_month(samples_summary_tbls_lst$ft,
                        font_size = 8,
                        header_font_size = 9,
                        caption = cap)
```

```{r srg-canada-sample-summary-ss-tab, results = "asis"}

cap <- paste0("Canadian sampling by month for ", last_data_yr, " in the Shoreside sector.")
table_sampling_by_month(samples_summary_tbls_lst$ss,
                        font_size = 8,
                        header_font_size = 9,
                        caption = cap)
```

**U.S. Sectors**

```{r srg-us-atsea-cp-sampling-summary-tab, results = "asis"}

d<- tibble(month = c("May", "Jun", "Jul", "Aug", "Sep", "Oct", "Total"),
           num_age = c(250, 135, 0, 0, 0, 170, 555),
           num_length = c(507, 269, 0, 0, 0, 541, 1317),
           num_weight = c(507, 269, 0, 0, 0, 541, 1317))

cap <- paste0("U.S. sampling by month for ", last_data_yr, " in the catcher-processor at-sea sector.")
table_sampling_by_month(d,
                        font_size = 8,
                        header_font_size = 9,
                        caption = cap)
```

```{r srg-us-at-sea-ms-sampling-summary-tab, results = "asis"}

d <- tibble(month = c("May", "Jun", "Jul", "Aug", "Sep", "Oct", "Total"),
            num_age = c(0, 134, 164, 177, 150, 38, 663),
            num_length = c(0, 266, 311, 319, 276, 64, 1236),
            num_weight = c(0, 266, 311, 319, 276, 64, 1236))

cap <- paste0("U.S. sampling by month for ", last_data_yr, " in the mothership at-sea sector.")
table_sampling_by_month(d,
                        font_size = 8,
                        header_font_size = 9,
                        caption = cap)
```


```{r srg-us-sb-sampling-summary-tab, results = "asis"}

d <- tibble(month = c("April", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Total"),
            num_age = c(2, 118, 229, 450, 370, 290, 170, 0, 1629),
            num_length = c(6, 78, 360, 440, 440, 340, 388, 20, 2066),
            num_weight = c(6, 78, 360, 440, 440, 340, 388, 20, 2066))

cap <- paste0("U.S. sampling by month for ", last_data_yr, " in the shore-based sector.")
table_sampling_by_month(d,
                        font_size = 8,
                        header_font_size = 9,
                        caption = cap)
```

### Request 2

**SRG request:**
Show the expected fishery age proportions for 2025 and 2026 fishery (this is fig 43 in 2025 assessment and slide 10 of management outcomes presentation). Possibly overlay this with 2025 fishery observations to compare the two. The JTC can decide how to present the observed 2025 fishery data.

**Justification:**
This request will identify the correct predictions of fishery proportions-at-age for 2025 and 2026, thus providing insights into what the model expects  for 2025 fisheries proportions-at-age. Comparing to the observations from 2025 will help to identify potential biases in the assessment, in particular related to the assumption of fixing recent recruitment to less than average recruitment.

#### Request 2 results: 

```{r srg-fore-age-props-tab, results = "asis"}

cap <- paste0("Vulnerable projected age compositions for ", assess_yr, ".")
table_fore_age_props(fore_catch_prop,
                     fore_catch_prop_wt,
                     ages_filt = 1:15,
                     font_size = 8,
                     caption = cap)
```

(ref:srg-main-age-comp-forecast-cap) Vulnerable projected age compositions for `r assess_yr`. The left panel shows the proportions by number; the right panel shows the proportions by weight. Selectivity for `r assess_yr` was not available in the model output so `r last_data_yr` was used instead.

(ref:srg-main-age-comp-forecast-alt) This figure shows that age 5 and 6 fish will be dominant in the stock in `r assess_yr`

```{r srg-age-comp-forecast-fig, fig.cap = "(ref:srg-main-age-comp-forecast-cap)", fig.height = 4, fig.asp = 0.8, out.height = "4in"}

plot_fore_age_comps(base_model,
                    y_lim = c(0, 0.7),
                    is_catch_proj = TRUE)
```

(ref:srg-age-comp-forecast-comparison-cap) Proportions of `r last_data_yr` catch-at-age, expected proportions of catch-at-age from the `r last_data_yr` assessment model, and expected proportions of catch-at-age from the `r assess_yr` assessment model.

(ref:srg-age-comp-forecast-comparison-alt) This figure shows that the expected proportions of catch-at-age follow what is seen in the `r last_data_yr` data except for the large cohort of age 2's. The `r last_data_yr` data was not included in the model

```{r srg-age-comp-forecast-comparison-fig, fig.cap = "(ref:srg-age-comp-forecast-comparison-cap)", fig.height = 5, fig.asp = 0.8, out.height = "6in"}

# load fishery 2025 age props and plot
d <- read_csv(here("beamer-catch-proj/srg/requests/requests-day-1/fishery-age-props-2025.csv"), col_types = cols())
x_lim <- c(1, 15)
x_breaks <- seq(x_lim[1], x_lim[2], 2)
y_lim = c(0, 0.55)

plist <- NULL
plist[[1]] <- ggplot(d,
                     aes(x = age,
                         y = prop)) +
  geom_bar(stat = "identity",
           fill = main_fill,
           alpha = main_alpha) +
  scale_x_continuous(breaks = x_breaks,
                     labels = x_breaks) +
  scale_y_continuous(expand = c(0, 0)) +
  coord_cartesian(xlim = x_lim,
                  ylim = y_lim,
                  expand = TRUE) +
  xlab("") +
  ylab("Prop. 2025 catch") +
  ggtitle("") +
  theme(plot.title = element_text(hjust = 0.5))

plist[[2]] <- plot_fore_age_comps(last_yr_base_model,
                                  y_lim = c(0, 0.7),
                                  by_number_only = TRUE,
                                  show_x_title = FALSE)

plist[[3]] <- plot_fore_age_comps(base_model,
                                  y_lim = c(0, 0.7),
                                  by_number_only = TRUE,
                                  is_catch_proj = TRUE)

plot_grid(plotlist = plist, nrow = 3, align = "v")

```

### Request 3

**SRG request:**
Present the table of spawning biomass, age 2+ biomass and other quantities as in Table 23 from the 2025 assessment, and include this updated version in the 2026 assessment document.

**Justification:**
These quantities will help provide insight into the possible predicted size of the 2025 acoustic survey biomass.

#### Request 3 results: 

```{r srg-base-median-posterior-tab, results = "asis", echo = FALSE}

table_median_posteriors(
  base_model,
  start_yr = start_yr,
  end_yr = end_yr,
  digits = 1,
  caption = paste0(
    "Time series of median posterior population estimates from the base ",
    "model. Relative spawning biomass is spawning biomass relative to the ",
    "unfished equilibrium (", b_0_for_latex_table, "). Total biomass includes
    females and males of ages 0 and above. Age-2$+$ biomass includes females ",
    "and males ages 2 and above. Exploitation fraction is total catch ",
    "divided by total age-2$+$ biomass. Relative fishing intensity is ",
    rel_fishing_intensity_for_latex_table, " such that values below 100\\% ",
    "represent fishing below ", f_40_for_latex_table, ". In the last row, ",
    "dashes (--) indicate quantities requiring ", end_yr, " catch which has ",
    "not taken place yet."),
  font_size = 8,
  header_font_size = 9,
  longtable = TRUE)
```

### Request 4

**SRG request:**
Create and present the plot showing the amount of each cohort in the catch over time (age on the x-axis). This plot has been created in the past. Please include the 1999, 2010, 2014, 2016, 2017, 2020, and 2021 cohorts.

**Justification:**
This plot shows the rate of removals of a cohort over time and how it compares across cohorts, which is helpful to understand the importance of a cohort to the fishery.

#### Request 4 results: 

Estimated total catch from each cohort

* 1999 cohort (ages 1--`r last_data_yr - 1999`): `r f(max(cohort_cum_sum_1999))` t
* 2010 cohort (ages 1--`r last_data_yr - 2010`): `r f(max(cohort_cum_sum_2010))` t
* 2014 cohort (ages 1--`r last_data_yr - 2014`): `r f(max(cohort_cum_sum_2014))` t
* 2016 cohort (ages 1--`r last_data_yr - 2016`): `r f(max(cohort_cum_sum_2016))` t
* 2017 cohort (ages 1--`r last_data_yr - 2017`): `r f(max(cohort_cum_sum_2017))` t
* 2020 cohort (ages 1--`r last_data_yr - 2020`): `r f(max(cohort_cum_sum_2020))` t
* 2021 cohort (ages 1--`r last_data_yr - 2021`): `r f(max(cohort_cum_sum_2021))` t

(ref:srg-cumulative-catch-cohorts-cap) Cumulative catch of key cohorts as requested by the SRG.

(ref:srg-cumulative-catch-cohorts-alt) This figure shows the trajectories of catch on key cohorts 

```{r srg-cumulative-catch-cohorts-fig, fig.cap = "(ref:srg-cumulative-catch-cohorts-cap)", fig.height = 4, fig.asp = 0.8, out.height = "4in"}

plot_cumulative_catch_cohorts(base_model,
                              leg_pos = c(0.1, 0.8))
```

### Request 5

**SRG request:**
Calculate and present probability tables (slide 15 of management outcomes) for each sensitivity run (at least the no additional standard error on the survey and the stochastic recruitment runs).

**Justification:**
This will provide an insight into the management outcomes for alternative model runs and identify the importance (through the size of the effect) to management outcomes.

#### Request 5 results: 

```{r srg-risk-base-tab, results = "asis"}

cap <- paste0("Probabilities based on ", end_yr, " catch (Base Model).")
table_risk(base_model,
           forecast_yrs,
           index = 1,
           is_catch_proj = TRUE,
           type = "probability",
           font_size = 8,
           header_font_size = 9,
           caption = cap)
```

```{r srg-risk-sens1-tab, results = "asis"}

cap <- paste0("Probabilities based on ", end_yr, " catch (Stochastic forecast recruitment).")
table_risk(sens_models[[1]][[2]],
           forecast_yrs,
           index = 1,
           is_catch_proj = TRUE,
           type = "probability",
           font_size = 8,
           header_font_size = 9,
           caption = cap)
```

```{r srg-risk-sens2-tab, results = "asis"}

cap <- paste0("Probabilities based on ",
              end_yr,
              " catch (Stochastic forecast recruitment and Fit Survey).")
table_risk(sens_models[[1]][[3]],
           forecast_yrs,
           index = 1,
           is_catch_proj = TRUE,
           type = "probability",
           font_size = 8,
           header_font_size = 9,
           caption = cap)
```

```{r srg-risk-sens3-tab, results = "asis"}

cap <- paste0("Probabilities based on ", end_yr, " catch (Fit Survey).")
table_risk(sens_models[[1]][[4]],
           forecast_yrs,
           index = 1,
           is_catch_proj = TRUE,
           type = "probability",
           font_size = 8,
           header_font_size = 9,
           caption = cap)
```

### Request 6

**SRG request:**
Present the fish age throughout the 2025 season for each sector. Presenting age would remove confounding growth. Monthly would be preferred, but could be spring/summer/fall, or simply early and late, if necessary.

**Justification:**
This will address a question from the public and inform the SRG on differences in catch throughout the season. It will also help to identify when the age-1 fish became prominent and may help to understand why certain percentages are in the data but may not be in the prediction or in what stakeholders perceived for the season.

#### Request 6 results: 

(ref:srg-canada-age-proportions-cap) Canadian proportion-at-age by month and fleet for `r last_data_yr`.

(ref:srg-canada-age-proportions-alt) This figure shows the canadian catch by month for `r last_data_yr`

```{r srg-canada-age-proportions-fig, fig.cap = "(ref:srg-canada-age-proportions-cap)", results = "asis", fig.out = 3, fig.asp = 0.8, out.height = "3in"}

sample_df <- canada_load_sample_data() |>
  dplyr::filter(sex %in% c(1, 2))
fleet_lst <- canada_get_fleet_samples(sample_df)
# Remove JV for this table
fleet_lst <- fleet_lst[names(fleet_lst) != "jv"]

plot_age_by_month(fleet_lst)
```

(ref:srg-us-atsea-age-proportions-cap) U.S. at-sea proportion-at-age by month and fleet for `r last_data_yr`.

(ref:srg-us-atsea-age-proportions-alt) This figure shows the U S at sea catch by month for `r last_data_yr`

```{r srg-us-atsea-age-proportions-fig, fig.cap = "(ref:srg-us-atsea-age-proportions-cap)", results = "asis", fig.out = 4, fig.asp = 0.8, out.height = "4in"}

include_graphics("/srv/hake/other/samples/us/srg-request-6-at-sea-age-proportions.png")
```

(ref:srg-us-shoreside-age-proportions-cap) U.S. shoreside proportion-at-age by month and fleet for `r last_data_yr`.

(ref:srg-us-shoreside-age-proportions-alt) This figure shows the U S shoreside catch by month for `r last_data_yr`

```{r srg-us-shoreside-age-proportions-fig, fig.cap = "(ref:srg-us-shoreside-age-proportions-cap)", results = "asis", fig.out = 4, fig.asp = 0.8, out.height = "4in"}

include_graphics("/srv/hake/other/samples/us/srg-request-6-ss-age-proportions.png")
```


### Request 7

**SRG request:**
Extend the assessment model to incorporate data through 2025 and fit to fishery age compositions, acoustic survey biomass index, and acoustic survey age compositions. If this is not possible, or not preferable, please provide an explanation.

**Justification:**
This will provide insight into the likely outcomes from an assessment incorporating all of the 2025 data.

#### Request 7 results:

The JTC supplied the following reasons for not extending the assessment model to incorporate data through `r last_data_yr`.

A catch-only projection is appropriate for the 2026 stock assessment for several reasons that complement the Introduction of the draft assessment document.

* The 2025 IWCPS acoustic survey biomass and age-composition estimates were finalized only days before the assessment deadline (i.e., shortly before the SRG meeting) due to a 7-week delay caused by an external time constraint (U.S. federal government shutdown). Consequently, these data have not had the necessary review by the JTC. The 2025 IWCPS survey had meaningful survey design changes. Incorporating these data without proper review by the SRG may result in assumptions that result in biased results. 

* Data from both the fishery and acoustic survey are complementary to provide a more informative representation of the population. Including the 2025 fishery age compositions without including the 2025 survey biomass estimate (and age compositions) risks introducing biases. In recent years, a tension has been observed between fishery age composition data (suggesting high recruitment from shifts to large proportions of young fish) and the acoustic survey biomass index (suggesting decreasing overall biomass). 

* The next full stock assessment should include the full complement of properly scrutinized data informing both cohort strengths and absolute biomass.

Therefore, it is not appropriate to run new base case models for management advice during the SRG that include 2025 age composition and 2025 IWCPS biomass estimates for several reasons:

* There is insufficient time to properly review changes in new survey and trawl net designs (including selectivity and other nuances specific to the 2025 IWCPS) and then also evaluate how results from that review should be incorporated into the stock assessment.

* There is insufficient time for proper implementation of review suggestions that often require comparing alternative approaches and identifying robust options.  

* There is insufficient time to properly process all of the survey-dependent data products used in a full stock assessment (including maturity-at-age, weight-at-age, and appropriately catch-weighted fishery age compositions).

* There is insufficient time to conduct the suite of sensitivities and all other diagnostic model evaluations required for a full stock assessment.
