# Past management

## Past management: Total Allowable Catch
```{r tac-vs-realized-catch-ts, fig.height = 3.5, fig.width = 7.5, out.height = "80%"}

plot_management_catch_vs_tac(catch_targets_df,
                             curr_assess_biomass = base_model$ct_default_policy[1],
                             leg_pos = c(0.18, 0.9),
                             leg_font_size = 9)

def_med_hr_tac <- catch_targets_df |>
  dplyr::filter(Year == last_assess_yr) |>
  select(`Default HCR TAC`) |>
  unlist()

tac_catch_diff_df <- catch_targets_df |>
  dplyr::filter(Year >= assess_yr - 10) |>
  mutate(diff = `Realized catch` / `Total TAC`)
tac_catch_diff <- tac_catch_diff_df |>
  pull(diff)
rng_tac_catch <- range(tac_catch_diff)
rng_tac_catch_txt <- f(range(tac_catch_diff) * 100)
k1 <- which(tac_catch_diff_df$diff == rng_tac_catch[1])
k2 <- which(tac_catch_diff_df$diff == rng_tac_catch[2])
rng_tac_catch_yr_lo <- tac_catch_diff_df[k1, ] |> pull(Year)
rng_tac_catch_yr_hi <- tac_catch_diff_df[k2, ] |> pull(Year)
```

## Past management: Total Allowable Catch
:::::: {.columns}
::: {.column width="40%"}
* March `r last_assess_yr`
  - Default Harvest Control Rule TAC was `r f(def_med_hr_tac)` t
  - Total TAC was `r last_yr_tac` t
\item[]
* When Default HCR suggests a large catch, Total TAC is often set less
\item[]
* In the last 10 years, realized catches were between
  `r rng_tac_catch_txt[1]`% and `r rng_tac_catch_txt[2]`% of the Total TAC
  (`r rng_tac_catch_yr_lo` and `r rng_tac_catch_yr_hi`)
:::

::: {.column width="60%"}
```{r tac-vs-realized-catch, fig.height = 4, fig.width = 6.5, out.height = "75%"}

plot_management_catch_vs_tac_1_to_1(catch_targets_df,
                                    yrs_nudge_right = c(2006, 2010, 2011,
                                                        2012, 2014, 2019,
                                                        2020))
```
:::
::::::

## Past management: Total Allowable Catch
```{r tac-vs-realized-catch-ts-table, results = "asis"}

plot_management_catch_vs_tac(catch_targets_df,
                             ret_tbl = TRUE,
                             font_size = 6)
```

